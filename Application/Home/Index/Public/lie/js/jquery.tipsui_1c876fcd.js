!function($,window,undefined){function Plugin(element,options,method){this.element=$(element),this.options=$.extend({},defaults,options),this._defaults=defaults,this._name=pluginName.toLowerCase(),this._asize={width:10,height:10},this._container=$("<div />").addClass(this._name).addClass(this._name+"-"+this.options.position),this._content=$("<div />").addClass(this._name+"-content").appendTo(this._container),this._arrow=$('<div class="'+this._name+'-arrow"><i></i><em></em></div>').appendTo(this._container),this.init()}var pluginName="TipsUI",ie6=window.VBArray&&!window.XMLHttpRequest,document=window.document,methodHandler=["destroy","setOption","refresh"],defaults={type:"click",close:!0,content:"",relative:!1,left:0,top:0,index:0,width:120,show:!1,position:"bottom",css:null};Plugin.prototype.init=function(){var that=this;return that.options.relative?that._container.insertAfter(this.element):that._container.appendTo("body"),that.options.index&&that._container.css({"z-index":that.options.index}),"hover"===that.options.type?that.element.hover(function(){that.show()._refresh()},function(){that.hide()}):that.element.bind(that.options.type,function(){that._container.is(":visible")?that.hide():that.show()._refresh()}),that.options.close===!1?that._content.css({"margin-right":0}):(that._close=$('<a href="javascript:;" class="'+that._name+'-close">&times;</a>').appendTo(that._container),that._close.bind("click",function(){that.options.close&&that.close()&&"function"==typeof that.options.close&&that.options.close.call(that)})),that.options.css&&that._content.css(that.options.css),that.refresh(),!that.options.show&&that.hide(),!that.options.relative&&$(window).bind("resize",function(){that._refresh()}),that},Plugin.prototype._css=function(param){return parseInt(this.element.css(param).replace(/[^\d]/g,"")||0)},Plugin.prototype.content=function(content,refresh){var that=this;content=content||that.options.content||that.element.attr("title")||"","string"==typeof content?(that._content.html(content),refresh&&that._refresh(),!that._content.html()&&that.hide()):"function"==typeof content?(that._content.html(content.call(that)),refresh&&that._refresh(),!that._content.html()&&that.hide()):"object"==typeof content&&content.url&&$.ajax({url:content.url,type:content.type||"GET",dataType:content.dataType||"json",cache:content.cache||!1,success:function(data){content.success&&that._content.html(content.success.call(that,data)),refresh&&that._refresh(),!that._content.html()&&that.hide()}})},Plugin.prototype.refresh=function(){var that=this;return that.content(that.options.content,!0),that},Plugin.prototype._refresh=function(){var that=this,size={width:that.element.innerWidth(),height:that.element.innerHeight()},margin={left:that._css("margin-left"),right:that._css("margin-right"),top:that._css("margin-top"),bottom:that._css("margin-bottom")},tsize={width:that._container.innerWidth(),height:that._container.innerHeight()},position=that.options.relative?that.element.position():that.element.offset(),params={width:that.options.width},aparams={};switch(that.options.position){case"left":params.left=position.left-tsize.width-that._asize.width+margin.left,params.top=that.options.top?position.top-that.options.top+size.height/2+margin.top:position.top-tsize.height/2+size.height/2+margin.top,aparams.right=-that._asize.width/2,aparams.top=that.options.top?position.top-size.height/2:tsize.height/2-size.height/2;break;case"right":params.left=position.left+size.width+that._asize.width+margin.left,params.top=that.options.top?position.top-that.options.top+size.height/2+margin.top:position.top-tsize.height/2+size.height/2+margin.top,aparams.left=-that._asize.width/2,aparams.top=that.options.top?position.top-size.height/2:tsize.height/2-size.height/2;break;case"bottom":params.left=that.options.left?position.left-that.options.left+size.width/2+margin.left:position.left-that.options.width/2+size.width/2+margin.left,params.top=position.top+size.height+that._asize.height/2,aparams.left=that.options.left?that.options.left-size.width/2-that._asize.width/2:that.options.width/2-that._asize.width/2,aparams.top=-that._asize.height/2;break;case"top":params.left=that.options.left?position.left-that.options.left+size.width/2+margin.left:position.left-that.options.width/2+size.width/2+margin.left,params.top=position.top-tsize.height-that._asize.height/2,aparams.left=that.options.left?that.options.left-that._asize.width/2:that.options.width/2-that._asize.width/2,aparams.bottom=-that._asize.height/2}return that._container.css(params),that._arrow.css(aparams),that},Plugin.prototype.setOption=function(option){return $.extend(this.options,option),this},Plugin.prototype.show=function(){return this._container.show(),this},Plugin.prototype.hide=function(){return this._container.hide(),this},Plugin.prototype.close=function(){return this.hide(),this},$.fn[pluginName]=$.fn[pluginName]||function(options){var args,method,isHandler,_plugin;if("string"==typeof options){if(args=arguments,method=options,isHandler=function(){for(var i=0;i<methodHandler.length;i++)if(methodHandler[i]===method)return!0;return!1},Array.prototype.shift.call(args),"check"==method)return!!this.data("plugin_"+pluginName);if(isHandler())return this.each(function(){var _plugin=$(this).data("plugin_"+pluginName);_plugin&&_plugin[method]&&_plugin[method].apply(_plugin,args)});if(_plugin=this.first().data("plugin_"+pluginName),_plugin&&_plugin[method])return _plugin[method].apply(_plugin,args);throw new TypeError(pluginName+' has no method "'+method+'"')}return this.each(function(){var _plugin=$(this).data("plugin_"+pluginName);_plugin?_plugin.setOption.call(_plugin,options).refresh():$(this).data("plugin_"+pluginName,new Plugin(this,options))})}}(jQuery,window);